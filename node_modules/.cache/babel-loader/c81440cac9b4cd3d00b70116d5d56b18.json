{"ast":null,"code":"import _regeneratorRuntime from\"/Users/ffaiku/opt/FH/4 Semester/Verteilte Systeme/Project/smart-home-ui/smart-home-ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/ffaiku/opt/FH/4 Semester/Verteilte Systeme/Project/smart-home-ui/smart-home-ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"/Users/ffaiku/opt/FH/4 Semester/Verteilte Systeme/Project/smart-home-ui/smart-home-ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/ffaiku/opt/FH/4 Semester/Verteilte Systeme/Project/smart-home-ui/smart-home-ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";export var AbstractRequestApi=/*#__PURE__*/function(){function AbstractRequestApi(){_classCallCheck(this,AbstractRequestApi);this.defaultHeader={Accept:'application/json','Content-Type':'application/json','Access-Control-Allow-Origin':'*'};}_createClass(AbstractRequestApi,[{key:\"_makeRequest\",value:function(){var _makeRequest2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(url,method,body,headers){var _this=this;var newHeaders,response,errorMsg;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:newHeaders=this._addHeader(headers);_context.prev=1;_context.next=4;return this.timeoutWrapper(this.getTimeout(),fetch(url,{headers:newHeaders,body:JSON.stringify(body),method:method}));case 4:response=_context.sent;if(response.ok){_context.next=10;break;}_context.next=8;return response.json();case 8:errorMsg=_context.sent;throw new Error(errorMsg);case 10:return _context.abrupt(\"return\",response.json().then(function(data){return _this.checkForErrorData(data);}));case 13:_context.prev=13;_context.t0=_context[\"catch\"](1);console.log(_context.t0);throw new Error(_context.t0);case 17:case\"end\":return _context.stop();}}},_callee,this,[[1,13]]);}));function _makeRequest(_x,_x2,_x3,_x4){return _makeRequest2.apply(this,arguments);}return _makeRequest;}()},{key:\"getTimeout\",value:function getTimeout(){return 50000;}},{key:\"checkForErrorData\",value:function checkForErrorData(data){if(data.errors){return Promise.reject(new Error(data.errors));}return data;}},{key:\"_addHeader\",value:function _addHeader(optionalHeaders){var headers=this.defaultHeader;if(optionalHeaders){Object.keys(optionalHeaders).forEach(function(key){return headers[key]=optionalHeaders[key];});}return headers;}},{key:\"timeoutWrapper\",value:function timeoutWrapper(millis,promise){return new Promise(function(resolve,reject){var timeoutId=setTimeout(function(){reject(new Error(\"Error\"));},millis);promise.then(function(res){clearTimeout(timeoutId);resolve(res);},function(err){clearTimeout(timeoutId);reject(err);});});}}]);return AbstractRequestApi;}();","map":{"version":3,"sources":["/Users/ffaiku/opt/FH/4 Semester/Verteilte Systeme/Project/smart-home-ui/smart-home-ui/src/api/makeRequest.tsx"],"names":["AbstractRequestApi","defaultHeader","Accept","url","method","body","headers","newHeaders","_addHeader","timeoutWrapper","getTimeout","fetch","JSON","stringify","response","ok","json","errorMsg","Error","then","data","checkForErrorData","console","log","errors","Promise","reject","optionalHeaders","Object","keys","forEach","key","millis","promise","resolve","timeoutId","setTimeout","res","clearTimeout","err"],"mappings":"2yBAEA,UAAaA,CAAAA,kBAAb,qGAEEC,aAFF,CAEkB,CACdC,MAAM,CAAE,kBADM,CAEd,eAAgB,kBAFF,CAGd,8BAA+B,GAHjB,CAFlB,mKAQyBC,GARzB,CAQsCC,MARtC,CAQsDC,IARtD,CAQkEC,OARlE,kKASUC,UATV,CASuB,KAAKC,UAAL,CAAgBF,OAAhB,CATvB,uCAY6B,MAAKG,cAAL,CACrB,KAAKC,UAAL,EADqB,CAErBC,KAAK,CAACR,GAAD,CAAM,CACTG,OAAO,CAAEC,UADA,CAETF,IAAI,CAAEO,IAAI,CAACC,SAAL,CAAeR,IAAf,CAFG,CAGTD,MAAM,CAANA,MAHS,CAAN,CAFgB,CAZ7B,QAYYU,QAZZ,kBAqBWA,QAAQ,CAACC,EArBpB,gDAsBuCD,CAAAA,QAAQ,CAACE,IAAT,EAtBvC,QAsBcC,QAtBd,oBAuBc,IAAIC,CAAAA,KAAJ,CAAUD,QAAV,CAvBd,yCAyBaH,QAAQ,CAACE,IAAT,GAAgBG,IAAhB,CAAqB,SAACC,IAAD,QAAe,CAAA,KAAI,CAACC,iBAAL,CAAuBD,IAAvB,CAAf,EAArB,CAzBb,4DA2BME,OAAO,CAACC,GAAR,cA3BN,KA4BY,IAAIL,CAAAA,KAAJ,aA5BZ,iOAgCuB,CACnB,MAAO,MAAP,CACD,CAlCH,4DAoCoBE,IApCpB,CAoC+B,CAC3B,GAAIA,IAAI,CAACI,MAAT,CAAiB,CACf,MAAOC,CAAAA,OAAO,CAACC,MAAR,CAAe,GAAIR,CAAAA,KAAJ,CAAUE,IAAI,CAACI,MAAf,CAAf,CAAP,CACD,CACD,MAAOJ,CAAAA,IAAP,CACD,CAzCH,8CA2CaO,eA3Cb,CA2C8C,CAC1C,GAAMrB,CAAAA,OAAO,CAAG,KAAKL,aAArB,CAEA,GAAI0B,eAAJ,CAAqB,CACnBC,MAAM,CAACC,IAAP,CAAYF,eAAZ,EAA6BG,OAA7B,CAAqC,SAAAC,GAAG,QAAKzB,CAAAA,OAAO,CAACyB,GAAD,CAAP,CAAeJ,eAAe,CAACI,GAAD,CAAnC,EAAxC,EACD,CACD,MAAOzB,CAAAA,OAAP,CACD,CAlDH,sDAqDiB0B,MArDjB,CAqDiCC,OArDjC,CAqDwD,CACpD,MAAO,IAAIR,CAAAA,OAAJ,CAAY,SAACS,OAAD,CAAUR,MAAV,CAAqB,CACtC,GAAMS,CAAAA,SAAS,CAAGC,UAAU,CAAC,UAAM,CACjCV,MAAM,CAAC,GAAIR,CAAAA,KAAJ,CAAU,OAAV,CAAD,CAAN,CACD,CAF2B,CAEzBc,MAFyB,CAA5B,CAGAC,OAAO,CAACd,IAAR,CACE,SAAAkB,GAAG,CAAI,CACLC,YAAY,CAACH,SAAD,CAAZ,CACAD,OAAO,CAACG,GAAD,CAAP,CACD,CAJH,CAKE,SAAAE,GAAG,CAAI,CACLD,YAAY,CAACH,SAAD,CAAZ,CACAT,MAAM,CAACa,GAAD,CAAN,CACD,CARH,EAUD,CAdM,CAAP,CAeD,CArEH","sourcesContent":["import { Method } from './ApiMethodEnum';\n\nexport class AbstractRequestApi {\n\n  defaultHeader = {\n    Accept: 'application/json',\n    'Content-Type': 'application/json',\n    'Access-Control-Allow-Origin': '*',\n  };\n\n  async _makeRequest<T>( url: string, method: Method, body?: any, headers?: any): Promise<T> {\n    const newHeaders = this._addHeader(headers);\n\n    try {\n      const response = await this.timeoutWrapper(\n        this.getTimeout(),\n        fetch(url, {\n          headers: newHeaders,\n          body: JSON.stringify(body),\n          method,\n        })\n      );\n\n      if (!response.ok) {\n        const errorMsg: string = await response.json();\n        throw new Error(errorMsg);\n      }\n      return response.json().then((data: any) => this.checkForErrorData(data));\n    } catch (error) {\n      console.log(error);\n      throw new Error(error);\n    }\n  }\n\n  getTimeout(): number {\n    return 50000;\n  }\n\n  checkForErrorData(data: any) {\n    if (data.errors) {\n      return Promise.reject(new Error(data.errors));\n    }\n    return data;\n  }\n\n  _addHeader(optionalHeaders?: string[]): any {\n    const headers = this.defaultHeader;\n\n    if (optionalHeaders) {\n      Object.keys(optionalHeaders).forEach(key => (headers[key] = optionalHeaders[key]));\n    }\n    return headers;\n  }\n\n\n  timeoutWrapper(millis: number, promise): Promise<any> {\n    return new Promise((resolve, reject) => {\n      const timeoutId = setTimeout(() => {\n        reject(new Error(\"Error\"));\n      }, millis);\n      promise.then(\n        res => {\n          clearTimeout(timeoutId);\n          resolve(res);\n        },\n        err => {\n          clearTimeout(timeoutId);\n          reject(err);\n        }\n      );\n    });\n  }\n}\n"]},"metadata":{},"sourceType":"module"}